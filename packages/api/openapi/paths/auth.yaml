# Authentication endpoint definitions

login:
  post:
    description: Login with email and password
    tags:
      - Auth
    operationId: login
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../schemas/auth.yaml#/LoginRequest
    responses:
      "200":
        description: Login successfully
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/LoginResponse
signup:
  post:
    description: Sign up a new user
    tags:
      - Auth
    operationId: signup
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../schemas/auth.yaml#/SignupRequest
    responses:
      "200":
        description: Sign up successfully
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/SignupResponse
logout:
  get:
    description: Logout
    tags:
      - Auth
    operationId: logout
    responses:
      "200":
        description: OK

passwordResetRequest:
  post:
    description: Request a password reset email
    tags:
      - Auth
    operationId: requestPasswordReset
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../schemas/auth.yaml#/PasswordResetRequest
    responses:
      "200":
        description: Email sent (if account exists)
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse
      "429":
        description: Too many requests for this user
        headers:
          Retry-After:
            schema:
              type: string
              description: Seconds until another request can be made
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse
      "500":
        description: Unable to send email
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse

passwordResetConfirm:
  post:
    description: Confirm password reset with token
    tags:
      - Auth
    operationId: confirmPasswordReset
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../schemas/auth.yaml#/PasswordResetConfirmRequest
    responses:
      "200":
        description: Password updated

magicLinkRequest:
  post:
    description: Request a magic link login email
    tags:
      - Auth
    operationId: requestMagicLink
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: ../schemas/auth.yaml#/MagicLinkRequest
    responses:
      "200":
        description: Email sent (if account exists)
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse
      "404":
        description: Email not found
      "429":
        description: Too many requests for this user
        headers:
          Retry-After:
            schema:
              type: string
              description: Seconds until another request can be made
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse
      "500":
        description: Unable to send email
        content:
          application/json:
            schema:
              $ref: ../schemas/auth.yaml#/EmailTokenResponse

magicLinkConsume:
  get:
    description: Consume magic link token and redirect with JWT
    tags:
      - Auth
    operationId: consumeMagicLink
    parameters:
      - in: query
        name: token
        schema:
          type: string
        required: true
    responses:
      "302":
        description: Redirect to frontend with token fragment
