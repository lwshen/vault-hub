# Audit log endpoint definition

auditLogs:
  get:
    description: Get audit logs with optional filtering and pagination
    tags:
      - Audit
    operationId: getAuditLogs
    parameters:
      - name: startDate
        in: query
        required: false
        description: Filter logs from this date (ISO 8601 format)
        schema:
          type: string
          format: date-time
      - name: endDate
        in: query
        required: false
        description: Filter logs until this date (ISO 8601 format)
        schema:
          type: string
          format: date-time
      - name: vaultUniqueId
        in: query
        required: false
        description: Filter logs by vault unique ID
        schema:
          type: string
      - name: source
        in: query
        required: false
        description: Filter logs by source (web interface or CLI)
        schema:
          type: string
          enum:
            - web
            - cli
      - name: pageSize
        in: query
        required: true
        description: Number of logs per page (default 100, max 1000)
        schema:
          type: integer
          minimum: 1
          maximum: 1000
          default: 20
      - name: pageIndex
        in: query
        required: true
        description: Page index, starting from 0 (default 0)
        schema:
          type: integer
          minimum: 1
          default: 1
    responses:
      "200":
        description: List of audit logs
        content:
          application/json:
            schema:
              $ref: ../schemas/audit.yaml#/AuditLogsResponse

auditMetrics:
  get:
    description: Get audit log metrics including total events and categorized counts
    tags:
      - Audit
    operationId: getAuditMetrics
    responses:
      "200":
        description: Audit log metrics
        content:
          application/json:
            schema:
              $ref: ../schemas/audit.yaml#/AuditMetricsResponse
